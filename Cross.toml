# Cross-compilation configuration
# https://github.com/cross-rs/cross

[build.env]
passthrough = [
    "RUST_BACKTRACE",
    "CARGO_TERM_COLOR",
]

[target.x86_64-unknown-linux-gnu]
pre-build = [
    "apt-get update && apt-get install -y libssl-dev pkg-config"
]

[target.x86_64-unknown-linux-musl]
pre-build = [
    "apt-get update && apt-get install -y musl-tools libssl-dev pkg-config"
]
# Use vendored OpenSSL for musl
[target.x86_64-unknown-linux-musl.env]
passthrough = ["OPENSSL_STATIC=1"]

[target.aarch64-unknown-linux-gnu]
pre-build = [
    "dpkg --add-architecture arm64",
    "apt-get update && apt-get install -y libssl-dev:arm64 pkg-config"
]
